<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Styled Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    {% load static %}
    
    <link rel="stylesheet" href="{% static 'css/r1_quest.css' %}">
    
</head>

<body>
    <!-- Team name outside, just above quiz-container -->
    <div class="team-container">
        <div class="team">
            <h1>{{ team }}</h1>
        </div>
    </div>

    <div class="quiz-container">
        <form method="post">
            {% csrf_token %}
            <div class="question-text">
                
                {% if bnt == "qes" %}
                <h1>{{ quest }}</h1>
                {% else %}
                {% if ans %}
                <h1>{{ quest }}</h1>
                <div class="response-message">Right</div>
                <div class="question-text">{{ quest.ans }}</div>
                {% else %}
                <h1>{{ quest }}</h1>
                <div class="response-message">Wrong</div>
                <input type="hidden" name="wrong" value="wrong">
                {% endif %}
                
                {% endif %}
            </div>

            <!-- Hidden inputs to store values -->
            <button type="hidden" name="bnt" id="bnt" value="{{ bnt }}"></button>

            <div class="status-bar">
                <div class="question-counter">Question {{ d_counter }} of {{ count }}</div>
            </div>

            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <input type="hidden" name="counter" value="{{ counter }}">
            <input type="hidden" name="pass_counter" value="{{ pass_counter }}">
            <input type="hidden" name="team_counter" value="{{ team_counter }}">
            <input type="hidden" name="ans" id="ans" value="">
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
    document.addEventListener('keydown', function (event) {
        const ansInput = document.getElementById('ans');
        const submitButton = document.getElementById('bnt');

        // If 'y' is pressed, set the answer to 'y' and submit the form
        if (event.key === 'y') {
            ansInput.value = 'y';
            if (submitButton) {
                submitButton.click();
            }
        }

        // If 'n' is pressed, set the answer to 'n' and submit the form
        if (event.key === 'n') {
            ansInput.value = 'n';
            if (submitButton) {
                submitButton.click();
            }
        }
    });

    // Fix progress bar calculation and animation
    const progressBar = document.getElementById('progress');
    const totalQuestions = parseInt('{{ count }}', 10);  // Total number of questions in the quiz
    const currentQuestion = parseInt('{{ d_counter }}', 10); // Current question number

    if (totalQuestions > 0 && currentQuestion > 0) {
        // Ensure progress is calculated properly
        const progressPercent = (currentQuestion / totalQuestions) * 100;

        // Apply progress only if calculated percentage is valid
        if (progressPercent <= 100 && progressPercent >= 0) {
            progressBar.style.width = progressPercent + '%';
        }
    }
});

    </script>
</body>

</html>
